!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.bondage=t():e.bondage=t()}(this,(function(){return(()=>{"use strict";var e={722:e=>{function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.exports=function(e){for(var n,r=[],i=e.split(/\r?\n+/).filter((function(e){return!e.match(/^\s*$/)})),a=null,o=!1,s=0;"#"===i[s][0]||!i[s].trim();)n||(n=[]),n.push(i[s].substr(1).trim()),s+=1;for(;s<i.length;s+=1)if("==="===i[s].trim())o=!1,n&&(a.filetags=n),r.push(a),a=null;else if(o)a.body+="".concat(i[s],"\n");else if("---"===i[s].trim())o=!0,a.body="";else if(i[s].indexOf(":")>-1){var u=t(i[s].split(":"),2),l=u[0],d=u[1],c=l.trim(),f=d.trim();if("body"!==c){if(null==a&&(a={}),a[c])throw new Error("Duplicate tag on node: ".concat(c));a[c]=f}}return r}},826:e=>{function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={}}var n,r;return n=e,(r=[{key:"set",value:function(e,t){this.data[e]=t}},{key:"get",value:function(e){return this.data[e]}}])&&t(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();e.exports=n},352:(e,t,n)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=((r=n(359))&&r.__esModule?r:{default:r}).default;t.default=i,e.exports=t.default},269:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(902))&&r.__esModule?r:{default:r};function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.transitions=[],this.textRule=null,this.isTrackingNextIndentation=!1,this.isEmittingEndOfLineTokens=!1}var t,n;return t=e,(n=[{key:"addTransition",value:function(e,t,n){return this.transitions.push({token:e,regex:i.default[e],state:t||null,delimitsText:n||!1}),this}},{key:"addTextRule",value:function(e,t){if(this.textRule)throw new Error("Cannot add more than one text rule to a state.");var n=[];this.transitions.forEach((function(e){e.delimitsText&&n.push("(".concat(e.regex.source,")"))}));var r="((?!".concat(n.join("|"),").)+");return this.addTransition(e,t),this.textRule=this.transitions[this.transitions.length-1],this.textRule.regex=new RegExp(r),this}},{key:"setTrackNextIndentation",value:function(e){return this.isTrackingNextIndentation=e,this}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=o,e.exports=t.default},271:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(304))&&r.__esModule?r:{default:r};function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.states=i.default.makeStates(),this.state="base",this.originalText="",this.lines=[],this.indentation=[[0,!1]],this.shouldTrackNextIndentation=!1,this.previousLevelOfIndentation=0,this.reset()}var t,n;return t=e,(n=[{key:"reset",value:function(){this.yytext="",this.yylloc={first_column:1,first_line:1,last_column:1,last_line:1},this.yylineno=1}},{key:"lex",value:function(){if(this.isAtTheEndOfText()){this.yytext="";var e=this.indentation.pop();return e&&e[1]?"Dedent":"EndOfInput"}return this.isAtTheEndOfLine()?(this.advanceLine(),"EndOfLine"):this.lexNextTokenOnCurrentLine()}},{key:"advanceLine",value:function(){this.yylineno+=1;var e=this.getCurrentLine().replace(/\t/,"    ");this.lines[this.yylineno-1]=e,this.previousLevelOfIndentation=this.getLastRecordedIndentation()[0],this.yytext="",this.yylloc={first_column:1,first_line:this.yylineno,last_column:1,last_line:this.yylineno}}},{key:"lexNextTokenOnCurrentLine",value:function(){var e=this.getCurrentLineIndentation();if(this.shouldTrackNextIndentation&&e>this.previousLevelOfIndentation)return this.indentation.push([e,!0]),this.shouldTrackNextIndentation=!1,this.yylloc.first_column=this.yylloc.last_column,this.yylloc.last_column+=e,this.yytext="","Indent";if(e<this.getLastRecordedIndentation()[0]){if(this.indentation.pop()[1])return this.yytext="",this.previousLevelOfIndentation=this.getLastRecordedIndentation()[0],"Dedent";this.lexNextTokenOnCurrentLine()}e===this.previousLevelOfIndentation&&1===this.yylloc.last_column&&(this.yylloc.last_column+=e);for(var t=this.getState().transitions,n=0,r=t.length;n<r;n+=1){var i=t[n],a=this.getCurrentLine().substring(this.yylloc.last_column-1).match(i.regex);if(null!==a&&0===a.index){var o=a[0];this.yytext=this.getCurrentLine().substr(this.yylloc.last_column-1,o.length),"String"===i.token&&(this.yytext=this.yytext.substring(1,this.yytext.length-1).replace(/\\/g,"")),this.yylloc.first_column=this.yylloc.last_column,this.yylloc.last_column+=o.length,i.state&&(this.setState(i.state),this.shouldTrackNextIndentation&&this.getLastRecordedIndentation()[0]<e&&this.indentation.push([e,!1]));var s=this.states[i.state],u=!s||s.transitions.find((function(e){return"Text"===e.token}));if("EndInlineExp"!==i.token&&"EscapedCharacter"!==i.token||!u){var l=this.getCurrentLine().substring(this.yylloc.last_column-1).match(/^\s*/);l[0]&&(this.yylloc.last_column+=l[0].length)}return i.token}}throw new Error("Invalid syntax in: ".concat(this.getCurrentLine()))}},{key:"setState",value:function(e){if(void 0===this.states[e])throw new Error("Cannot set the unknown state [".concat(e,"]"));this.state=e,this.getState().isTrackingNextIndentation&&(this.shouldTrackNextIndentation=!0)}},{key:"setInput",value:function(e){this.originalText=e.replace(/(\r\n)/g,"\n").replace(/\r/g,"\n").replace(/[\n\r]+$/,""),this.lines=this.originalText.split("\n"),this.reset()}},{key:"getState",value:function(){return this.states[this.state]}},{key:"getCurrentLine",value:function(){return this.lines[this.yylineno-1]}},{key:"getCurrentLineIndentation",value:function(){return this.getCurrentLine().match(/^(\s*)/g)[0].length}},{key:"getLastRecordedIndentation",value:function(){return 0===this.indentation.length?[0,!1]:this.indentation[this.indentation.length-1]}},{key:"isAtTheEndOfText",value:function(){return this.isAtTheEndOfLine()&&this.yylloc.first_line>=this.lines.length}},{key:"isAtTheEndOfLine",value:function(){return this.yylloc.last_column>this.getCurrentLine().length}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=o,e.exports=t.default},304:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(269))&&r.__esModule?r:{default:r},a={makeStates:function(){return{base:(new i.default).addTransition("EscapedCharacter",null,!0).addTransition("Comment",null,!0).addTransition("Hashtag",null,!0).addTransition("BeginCommand","command",!0).addTransition("BeginInlineExp","inlineExpression",!0).addTransition("ShortcutOption","shortcutOption").addTextRule("Text"),shortcutOption:(new i.default).setTrackNextIndentation(!0).addTransition("EscapedCharacter",null,!0).addTransition("Comment",null,!0).addTransition("Hashtag",null,!0).addTransition("BeginCommand","expression",!0).addTransition("BeginInlineExp","inlineExpressionInShortcut",!0).addTextRule("Text","base"),command:(new i.default).addTransition("If","expression").addTransition("Else").addTransition("ElseIf","expression").addTransition("EndIf").addTransition("Set","assignment").addTransition("Declare","declare").addTransition("Jump","jump").addTransition("Stop","stop").addTransition("EndCommand","base",!0).addTransition("Identifier","commandArg",!0).addTextRule("Text"),commandArg:(new i.default).addTransition("BeginInlineExp","inlineExpressionInCommand",!0).addTransition("EndCommand","base",!0).addTransition("LeftParen","commandParenArgOrExpression").addTransition("Variable").addTransition("Number").addTransition("String").addTransition("True").addTransition("False").addTransition("Identifier").addTransition("Comma").addTransition("RightParen"),commandParenArgOrExpression:(new i.default).addTransition("EndCommand","base",!0).addTransition("LeftParen","expression").addTransition("Variable","expression").addTransition("Number","expression").addTransition("String").addTransition("True").addTransition("False").addTransition("Null").addTransition("RightParen"),assignment:(new i.default).addTransition("Variable").addTransition("EqualToOrAssign","expression"),declare:(new i.default).addTransition("Variable").addTransition("EndCommand","base").addTransition("EqualToOrAssign","expression"),jump:(new i.default).addTransition("Identifier").addTransition("BeginInlineExp","inlineExpressionInCommand",!0).addTransition("EndCommand","base",!0),stop:(new i.default).addTransition("EndCommand","base",!0),expression:(new i.default).addTransition("As").addTransition("ExplicitType").addTransition("EndCommand","base").addTransition("Number").addTransition("String").addTransition("LeftParen").addTransition("RightParen").addTransition("EqualTo").addTransition("EqualToOrAssign").addTransition("NotEqualTo").addTransition("GreaterThanOrEqualTo").addTransition("GreaterThan").addTransition("LessThanOrEqualTo").addTransition("LessThan").addTransition("Add").addTransition("UnaryMinus").addTransition("Minus").addTransition("Exponent").addTransition("Multiply").addTransition("Divide").addTransition("Modulo").addTransition("And").addTransition("Or").addTransition("Xor").addTransition("Not").addTransition("Variable").addTransition("Comma").addTransition("True").addTransition("False").addTransition("Null").addTransition("Identifier").addTextRule(),inlineExpression:(new i.default).addTransition("EndInlineExp","base").addTransition("Number").addTransition("String").addTransition("LeftParen").addTransition("RightParen").addTransition("EqualTo").addTransition("EqualToOrAssign").addTransition("NotEqualTo").addTransition("GreaterThanOrEqualTo").addTransition("GreaterThan").addTransition("LessThanOrEqualTo").addTransition("LessThan").addTransition("Add").addTransition("UnaryMinus").addTransition("Minus").addTransition("Exponent").addTransition("Multiply").addTransition("Divide").addTransition("Modulo").addTransition("And").addTransition("Or").addTransition("Xor").addTransition("Not").addTransition("Variable").addTransition("Comma").addTransition("True").addTransition("False").addTransition("Null").addTransition("Identifier").addTextRule("Text","base"),inlineExpressionInCommand:(new i.default).addTransition("EndInlineExp","commandArg").addTransition("Number").addTransition("String").addTransition("LeftParen").addTransition("RightParen").addTransition("EqualTo").addTransition("EqualToOrAssign").addTransition("NotEqualTo").addTransition("GreaterThanOrEqualTo").addTransition("GreaterThan").addTransition("LessThanOrEqualTo").addTransition("LessThan").addTransition("Add").addTransition("UnaryMinus").addTransition("Minus").addTransition("Exponent").addTransition("Multiply").addTransition("Divide").addTransition("Modulo").addTransition("And").addTransition("Or").addTransition("Xor").addTransition("Not").addTransition("Variable").addTransition("Comma").addTransition("True").addTransition("False").addTransition("Null").addTransition("Identifier").addTextRule("Text","base"),inlineExpressionInShortcut:(new i.default).addTransition("EndInlineExp","shortcutOption").addTransition("Number").addTransition("String").addTransition("LeftParen").addTransition("RightParen").addTransition("EqualTo").addTransition("EqualToOrAssign").addTransition("NotEqualTo").addTransition("GreaterThanOrEqualTo").addTransition("GreaterThan").addTransition("LessThanOrEqualTo").addTransition("LessThan").addTransition("Add").addTransition("UnaryMinus").addTransition("Minus").addTransition("Exponent").addTransition("Multiply").addTransition("Divide").addTransition("Modulo").addTransition("And").addTransition("Or").addTransition("Xor").addTransition("Not").addTransition("Variable").addTransition("Comma").addTransition("True").addTransition("False").addTransition("Null").addTransition("Identifier").addTextRule("Text","base")}}};t.default=a,e.exports=t.default},902:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Whitespace:null,Indent:null,Dedent:null,EndOfLine:/\n/,EndOfInput:null,Number:/-?[0-9]+(\.[0-9+])?/,String:/"([^"\\]*(?:\\.[^"\\]*)*)"/,BeginCommand:/<</,EndCommand:/>>/,Variable:/\$([A-Za-z0-9_.])+/,ShortcutOption:/->/,Hashtag:/#([^(\s|#|//)]+)/,Comment:/\/\/.*/,OptionStart:/\[\[/,OptionDelimit:/\|/,OptionEnd:/\]\]/,If:/if(?!\w)/,ElseIf:/elseif(?!\w)/,Else:/else(?!\w)/,EndIf:/endif(?!\w)/,Jump:/jump(?!\w)/,Stop:/stop(?!\w)/,Set:/set(?!\w)/,Declare:/declare(?!\w)/,As:/as(?!\w)/,ExplicitType:/(String|Number|Bool)(?=>>)/,True:/true(?!\w)/,False:/false(?!\w)/,Null:/null(?!\w)/,LeftParen:/\(/,RightParen:/\)/,Comma:/,/,UnaryMinus:/-(?!\s)/,EqualTo:/(==|is(?!\w)|eq(?!\w))/,GreaterThan:/(>|gt(?!\w))/,GreaterThanOrEqualTo:/(>=|gte(?!\w))/,LessThan:/(<|lt(?!\w))/,LessThanOrEqualTo:/(<=|lte(?!\w))/,NotEqualTo:/(!=|neq(?!\w))/,Or:/(\|\||or(?!\w))/,And:/(&&|and(?!\w))/,Xor:/(\^|xor(?!\w))/,Not:/(!|not(?!\w))/,EqualToOrAssign:/(=|to(?!\w))/,Add:/\+/,Minus:/-/,Exponent:/\*\*/,Multiply:/\*/,Divide:/\//,Modulo:/%/,AddAssign:/\+=/,MinusAssign:/-=/,MultiplyAssign:/\*=/,DivideAssign:/\/=/,Identifier:/[a-zA-Z0-9_:.]+/,EscapedCharacter:/\\./,Text:/[^\\]/,BeginInlineExp:/{/,EndInlineExp:/}/},e.exports=t.default},87:(e,t)=>{function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=ce,t.parser=void 0;var a=function(e,t,n,r){for(n=n||{},r=e.length;r--;n[e[r]]=t);return n},o=[1,19],s=[1,20],u=[1,12],l=[1,18],d=[1,17],c=[5,18,19,24,35,37,80],f=[1,24],h=[1,25],p=[1,27],y=[1,28],b=[5,14,16,22,24,35,37],T=[5,14,16,18,19,22,24,35,37,80],m=[1,31],x=[1,32],v=[1,35],E=[1,36],g=[1,37],N=[1,38],w=[5,14,16,18,22,24,35,37,80],O=[1,42],k=[1,52],A=[1,51],_=[1,46],I=[1,47],S=[1,48],L=[1,53],j=[1,54],C=[1,55],P=[1,56],$=[1,57],R=[5,16,18,19,24,35,37,80],M=[1,68],q=[1,79],D=[1,80],B=[1,81],F=[1,82],G=[1,83],V=[1,84],U=[1,85],X=[1,86],J=[1,87],H=[1,88],Y=[1,89],z=[1,90],Z=[1,91],W=[1,92],K=[1,93],Q=[27,50,55,57,58,59,60,61,62,64,65,66,67,68,69,70,71,72,74,81],ee=[27,38,50,55,57,58,59,60,61,62,64,65,66,67,68,69,70,71,72,74,75,76,77,78,79,80,81],te=[27,38,75,76,77,78,79,80],ne=[27,50,55,57,58,59,60,61,64,65,66,67,68,69,70,71,72,74,81],re=[27,50,55,74,81],ie=[1,132],ae=[1,133],oe=[27,50,55,57,58,64,65,66,67,68,69,70,71,72,74,81],se=[27,50,55,64,65,66,67,68,69,70,71,72,74,81],ue=[55,74],le=[16,18,19,24,35,80],de={trace:function(){},yy:{},symbols_:{error:2,node:3,statements:4,EndOfInput:5,conditionalBlock:6,statement:7,text:8,shortcut:9,genericCommand:10,assignmentCommand:11,jumpCommand:12,stopCommand:13,Comment:14,hashtags:15,EndOfLine:16,escapedTextRaw:17,Text:18,EscapedCharacter:19,escapedText:20,inlineExpression:21,Hashtag:22,conditional:23,BeginCommand:24,If:25,expression:26,EndCommand:27,EndIf:28,additionalConditionalBlocks:29,else:30,Else:31,elseif:32,ElseIf:33,shortcutOption:34,ShortcutOption:35,Indent:36,Dedent:37,Identifier:38,genericCommandArguments:39,genericCommandArgument:40,literal:41,Jump:42,Stop:43,setCommandInner:44,declareCommandInner:45,Set:46,Variable:47,EqualToOrAssign:48,Declare:49,As:50,ExplicitType:51,functionArgument:52,functionCall:53,LeftParen:54,RightParen:55,UnaryMinus:56,Add:57,Minus:58,Exponent:59,Multiply:60,Divide:61,Modulo:62,Not:63,Or:64,And:65,Xor:66,EqualTo:67,NotEqualTo:68,GreaterThan:69,GreaterThanOrEqualTo:70,LessThan:71,LessThanOrEqualTo:72,parenExpressionArgs:73,Comma:74,True:75,False:76,Number:77,String:78,Null:79,BeginInlineExp:80,EndInlineExp:81,$accept:0,$end:1},terminals_:{2:"error",5:"EndOfInput",14:"Comment",16:"EndOfLine",18:"Text",19:"EscapedCharacter",22:"Hashtag",24:"BeginCommand",25:"If",27:"EndCommand",28:"EndIf",31:"Else",33:"ElseIf",35:"ShortcutOption",36:"Indent",37:"Dedent",38:"Identifier",42:"Jump",43:"Stop",46:"Set",47:"Variable",48:"EqualToOrAssign",49:"Declare",50:"As",51:"ExplicitType",54:"LeftParen",55:"RightParen",56:"UnaryMinus",57:"Add",58:"Minus",59:"Exponent",60:"Multiply",61:"Divide",62:"Modulo",63:"Not",64:"Or",65:"And",66:"Xor",67:"EqualTo",68:"NotEqualTo",69:"GreaterThan",70:"GreaterThanOrEqualTo",71:"LessThan",72:"LessThanOrEqualTo",74:"Comma",75:"True",76:"False",77:"Number",78:"String",79:"Null",80:"BeginInlineExp",81:"EndInlineExp"},productions_:[0,[3,2],[4,1],[4,2],[4,1],[4,2],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,2],[7,2],[7,2],[17,1],[17,1],[17,2],[17,2],[20,1],[8,1],[8,1],[8,2],[15,1],[15,2],[23,4],[6,6],[6,4],[6,2],[30,3],[30,2],[32,4],[32,2],[29,5],[29,5],[29,3],[34,2],[34,3],[34,2],[34,2],[34,3],[34,2],[9,1],[9,5],[10,3],[10,4],[39,1],[39,2],[40,1],[40,1],[40,1],[12,4],[12,4],[13,3],[11,3],[11,3],[44,4],[45,4],[45,6],[26,1],[26,1],[26,3],[26,2],[26,3],[26,3],[26,3],[26,3],[26,3],[26,3],[26,2],[26,3],[26,3],[26,3],[26,3],[26,3],[26,3],[26,3],[26,3],[26,3],[53,3],[53,4],[73,3],[73,1],[52,1],[52,1],[52,1],[41,1],[41,1],[41,1],[41,1],[41,1],[21,3]],performAction:function(e,t,n,i,a,o,s){var u=o.length-1;switch(a){case 1:return o[u-1].flat();case 2:case 4:case 7:case 8:case 9:case 10:case 11:case 21:case 46:case 82:case 20:this.$=[o[u]];break;case 3:case 22:this.$=o[u-1].concat(o[u]);break;case 5:case 47:this.$=o[u-1].concat([o[u]]);break;case 6:case 60:case 15:case 48:case 49:case 59:case 83:case 84:this.$=o[u];break;case 12:case 14:case 28:case 31:case 32:case 54:case 61:case 25:case 39:case 41:this.$=o[u-1];break;case 13:this.$=o[u-1].map((function(e){return Object.assign(e,{hashtags:o[u]})}));break;case 16:this.$=o[u].substring(1);break;case 17:this.$=o[u-1].concat(o[u].substring(1));break;case 18:this.$=o[u-1].substring(1).concat(o[u]);break;case 19:this.$=new i.TextNode(o[u],this._$);break;case 23:this.$=[o[u].substring(1)];break;case 24:this.$=[o[u-1].substring(1)].concat(o[u]);break;case 26:this.$=new i.IfNode(o[u-5],o[u-3].flat());break;case 27:this.$=new i.IfElseNode(o[u-3],o[u-1].flat(),o[u]);break;case 29:case 30:this.$=void 0;break;case 33:this.$=new i.ElseNode(o[u-3].flat());break;case 34:this.$=new i.ElseIfNode(o[u-4],o[u-3].flat());break;case 35:this.$=new i.ElseIfNode(o[u-2],o[u-1].flat(),o[u]);break;case 36:this.$={text:o[u]};break;case 37:this.$={text:o[u-1],conditional:o[u]};break;case 38:this.$=r(r({},o[u-1]),{},{hashtags:o[u]});break;case 40:this.$=r(r({},o[u-2]),{},{hashtags:o[u-1]});break;case 42:this.$=new i.DialogShortcutNode(o[u].text,void 0,this._$,o[u].hashtags,o[u].conditional);break;case 43:this.$=new i.DialogShortcutNode(o[u-4].text,o[u-1].flat(),this._$,o[u-4].hashtags,o[u-4].conditional);break;case 44:this.$=new i.FunctionResultNode(o[u-1],[],this._$);break;case 45:this.$=new i.FunctionResultNode(o[u-2],o[u-1],this._$);break;case 50:this.$=new i.TextNode(o[u]);break;case 51:case 52:this.$=new i.JumpNode(o[u-1]);break;case 53:this.$=new i.StopNode;break;case 55:this.$=null;break;case 56:this.$=new i.SetVariableEqualToNode(o[u-2].substring(1),o[u]);break;case 57:this.$=null,i.registerDeclaration(o[u-2].substring(1),o[u]);break;case 58:this.$=null,i.registerDeclaration(o[u-4].substring(1),o[u-2],o[u]);break;case 62:this.$=new i.UnaryMinusExpressionNode(o[u]);break;case 63:this.$=new i.ArithmeticExpressionAddNode(o[u-2],o[u]);break;case 64:this.$=new i.ArithmeticExpressionMinusNode(o[u-2],o[u]);break;case 65:this.$=new i.ArithmeticExpressionExponentNode(o[u-2],o[u]);break;case 66:this.$=new i.ArithmeticExpressionMultiplyNode(o[u-2],o[u]);break;case 67:this.$=new i.ArithmeticExpressionDivideNode(o[u-2],o[u]);break;case 68:this.$=new i.ArithmeticExpressionModuloNode(o[u-2],o[u]);break;case 69:this.$=new i.NegatedBooleanExpressionNode(o[u]);break;case 70:this.$=new i.BooleanOrExpressionNode(o[u-2],o[u]);break;case 71:this.$=new i.BooleanAndExpressionNode(o[u-2],o[u]);break;case 72:this.$=new i.BooleanXorExpressionNode(o[u-2],o[u]);break;case 73:this.$=new i.EqualToExpressionNode(o[u-2],o[u]);break;case 74:this.$=new i.NotEqualToExpressionNode(o[u-2],o[u]);break;case 75:this.$=new i.GreaterThanExpressionNode(o[u-2],o[u]);break;case 76:this.$=new i.GreaterThanOrEqualToExpressionNode(o[u-2],o[u]);break;case 77:this.$=new i.LessThanExpressionNode(o[u-2],o[u]);break;case 78:this.$=new i.LessThanOrEqualToExpressionNode(o[u-2],o[u]);break;case 79:this.$=new i.FunctionResultNode(o[u-2],[]);break;case 80:this.$=new i.FunctionResultNode(o[u-3],o[u-1]);break;case 81:this.$=o[u-2].concat([o[u]]);break;case 85:this.$=new i.VariableNode(o[u].substring(1));break;case 86:case 87:this.$=new i.BooleanLiteralNode(o[u]);break;case 88:this.$=new i.NumericLiteralNode(o[u]);break;case 89:this.$=new i.StringLiteralNode(o[u]);break;case 90:this.$=new i.NullLiteralNode(o[u]);break;case 91:this.$=new i.InlineExpressionNode(o[u-1],this._$)}},table:[{3:1,4:2,6:3,7:4,8:6,9:7,10:8,11:9,12:10,13:11,17:16,18:o,19:s,20:13,21:14,23:5,24:u,34:15,35:l,80:d},{1:[3]},{5:[1,21],6:22,7:23,8:6,9:7,10:8,11:9,12:10,13:11,17:16,18:o,19:s,20:13,21:14,23:5,24:u,34:15,35:l,80:d},a(c,[2,2],{16:f}),a(c,[2,4],{15:26,14:h,16:p,22:y}),{16:[1,29]},a(b,[2,6],{20:13,21:14,17:16,8:30,18:o,19:s,80:d}),a(T,[2,7]),a(T,[2,8]),a(T,[2,9]),a(T,[2,10]),a(T,[2,11]),{25:m,38:x,42:v,43:E,44:33,45:34,46:g,49:N},a(T,[2,20]),a(T,[2,21]),a(c,[2,42],{15:40,14:[1,41],16:[1,39],22:y}),a(w,[2,19],{19:O}),{21:49,26:43,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{8:58,17:16,18:o,19:s,20:13,21:14,80:d},a(T,[2,15]),a([5,14,16,22,24,35,37,80],[2,16],{17:59,18:o,19:s}),{1:[2,1]},a(c,[2,3],{16:f}),a(c,[2,5],{15:26,14:h,16:p,22:y}),a(R,[2,28]),a(T,[2,12]),a(T,[2,13]),a(T,[2,14]),a([5,14,16,18,19,24,35,37,80],[2,23],{15:60,22:y}),{4:61,6:3,7:4,8:6,9:7,10:8,11:9,12:10,13:11,17:16,18:o,19:s,20:13,21:14,23:5,24:u,34:15,35:l,80:d},a(b,[2,22],{20:13,21:14,17:16,8:30,18:o,19:s,80:d}),{21:49,26:62,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:66,27:[1,63],38:M,39:64,40:65,41:67,75:L,76:j,77:C,78:P,79:$,80:d},{27:[1,69]},{27:[1,70]},{21:72,38:[1,71],80:d},{27:[1,73]},{47:[1,74]},{47:[1,75]},a(T,[2,41],{36:[1,76]}),a([5,16,18,19,22,24,35,37,80],[2,38],{14:[1,77]}),a(T,[2,39]),a(T,[2,17]),{57:q,58:D,59:B,60:F,61:G,62:V,64:U,65:X,66:J,67:H,68:Y,69:z,70:Z,71:W,72:K,81:[1,78]},a(Q,[2,59]),a(Q,[2,60]),{21:49,26:94,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:95,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:96,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},a(Q,[2,83]),a(Q,[2,84]),a(Q,[2,85]),{54:[1,97]},a(ee,[2,86]),a(ee,[2,87]),a(ee,[2,88]),a(ee,[2,89]),a(ee,[2,90]),a([5,14,16,22,35,37],[2,36],{20:13,21:14,17:16,8:30,23:98,18:o,19:s,24:[1,99],80:d}),a(w,[2,18],{19:O}),a(T,[2,24]),{6:22,7:23,8:6,9:7,10:8,11:9,12:10,13:11,17:16,18:o,19:s,20:13,21:14,23:5,24:[1,100],29:101,30:102,32:103,34:15,35:l,80:d},{27:[1,104],57:q,58:D,59:B,60:F,61:G,62:V,64:U,65:X,66:J,67:H,68:Y,69:z,70:Z,71:W,72:K},a(T,[2,44]),{21:66,27:[1,105],38:M,40:106,41:67,75:L,76:j,77:C,78:P,79:$,80:d},a(te,[2,46]),a(te,[2,48]),a(te,[2,49]),a(te,[2,50]),a(T,[2,54]),a(T,[2,55]),{27:[1,107]},{27:[1,108]},a(T,[2,53]),{48:[1,109]},{48:[1,110]},{4:111,6:3,7:4,8:6,9:7,10:8,11:9,12:10,13:11,17:16,18:o,19:s,20:13,21:14,23:5,24:u,34:15,35:l,80:d},a(T,[2,40]),a([5,14,16,18,19,22,24,27,35,37,38,50,55,57,58,59,60,61,62,64,65,66,67,68,69,70,71,72,74,75,76,77,78,79,80,81],[2,91]),{21:49,26:112,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:113,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:114,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:115,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:116,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:117,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:118,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:119,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:120,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:121,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:122,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:123,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:124,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:125,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:126,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{55:[1,127],57:q,58:D,59:B,60:F,61:G,62:V,64:U,65:X,66:J,67:H,68:Y,69:z,70:Z,71:W,72:K},a(ne,[2,62],{62:V}),a(re,[2,69],{57:q,58:D,59:B,60:F,61:G,62:V,64:U,65:X,66:J,67:H,68:Y,69:z,70:Z,71:W,72:K}),{21:49,26:130,38:k,41:50,47:A,52:44,53:45,54:_,55:[1,128],56:I,63:S,73:129,75:L,76:j,77:C,78:P,79:$,80:d},a(T,[2,37]),{25:m},{25:m,28:[1,131],31:ie,33:ae,38:x,42:v,43:E,44:33,45:34,46:g,49:N},a(R,[2,27]),{4:134,6:3,7:4,8:6,9:7,10:8,11:9,12:10,13:11,16:[1,135],17:16,18:o,19:s,20:13,21:14,23:5,24:u,34:15,35:l,80:d},{4:136,6:3,7:4,8:6,9:7,10:8,11:9,12:10,13:11,16:[1,137],17:16,18:o,19:s,20:13,21:14,23:5,24:u,34:15,35:l,80:d},a(T,[2,25]),a(T,[2,45]),a(te,[2,47]),a(T,[2,51]),a(T,[2,52]),{21:49,26:138,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{21:49,26:139,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{6:22,7:23,8:6,9:7,10:8,11:9,12:10,13:11,17:16,18:o,19:s,20:13,21:14,23:5,24:u,34:15,35:l,37:[1,140],80:d},a(oe,[2,63],{59:B,60:F,61:G,62:V}),a(oe,[2,64],{59:B,60:F,61:G,62:V}),a(ne,[2,65],{62:V}),a(ne,[2,66],{62:V}),a(ne,[2,67],{62:V}),a(re,[2,68],{57:q,58:D,59:B,60:F,61:G,62:V,64:U,65:X,66:J,67:H,68:Y,69:z,70:Z,71:W,72:K}),a([27,50,55,64,74,81],[2,70],{57:q,58:D,59:B,60:F,61:G,62:V,65:X,66:J,67:H,68:Y,69:z,70:Z,71:W,72:K}),a([27,50,55,64,65,74,81],[2,71],{57:q,58:D,59:B,60:F,61:G,62:V,66:J,67:H,68:Y,69:z,70:Z,71:W,72:K}),a([27,50,55,64,65,66,74,81],[2,72],{57:q,58:D,59:B,60:F,61:G,62:V,67:H,68:Y,69:z,70:Z,71:W,72:K}),a(se,[2,73],{57:q,58:D,59:B,60:F,61:G,62:V}),a(se,[2,74],{57:q,58:D,59:B,60:F,61:G,62:V}),a(se,[2,75],{57:q,58:D,59:B,60:F,61:G,62:V}),a(se,[2,76],{57:q,58:D,59:B,60:F,61:G,62:V}),a(se,[2,77],{57:q,58:D,59:B,60:F,61:G,62:V}),a(se,[2,78],{57:q,58:D,59:B,60:F,61:G,62:V}),a(Q,[2,61]),a(Q,[2,79]),{55:[1,141],74:[1,142]},a(ue,[2,82],{57:q,58:D,59:B,60:F,61:G,62:V,64:U,65:X,66:J,67:H,68:Y,69:z,70:Z,71:W,72:K}),{27:[1,143]},{27:[1,144]},{21:49,26:145,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},{6:22,7:23,8:6,9:7,10:8,11:9,12:10,13:11,17:16,18:o,19:s,20:13,21:14,23:5,24:[1,146],34:15,35:l,80:d},a(le,[2,30]),{6:22,7:23,8:6,9:7,10:8,11:9,12:10,13:11,17:16,18:o,19:s,20:13,21:14,23:5,24:[1,147],29:148,30:102,32:103,34:15,35:l,80:d},a(le,[2,32]),{27:[2,56],57:q,58:D,59:B,60:F,61:G,62:V,64:U,65:X,66:J,67:H,68:Y,69:z,70:Z,71:W,72:K},{27:[2,57],50:[1,149],57:q,58:D,59:B,60:F,61:G,62:V,64:U,65:X,66:J,67:H,68:Y,69:z,70:Z,71:W,72:K},a(T,[2,43]),a(Q,[2,80]),{21:49,26:150,38:k,41:50,47:A,52:44,53:45,54:_,56:I,63:S,75:L,76:j,77:C,78:P,79:$,80:d},a(R,[2,26]),a(le,[2,29]),{27:[1,151],57:q,58:D,59:B,60:F,61:G,62:V,64:U,65:X,66:J,67:H,68:Y,69:z,70:Z,71:W,72:K},{25:m,28:[1,152],38:x,42:v,43:E,44:33,45:34,46:g,49:N},{25:m,28:[1,153],31:ie,33:ae,38:x,42:v,43:E,44:33,45:34,46:g,49:N},a(R,[2,35]),{51:[1,154]},a(ue,[2,81],{57:q,58:D,59:B,60:F,61:G,62:V,64:U,65:X,66:J,67:H,68:Y,69:z,70:Z,71:W,72:K}),a(le,[2,31]),{27:[1,155]},{27:[1,156]},{27:[2,58]},a(R,[2,33]),a(R,[2,34])],defaultActions:{21:[2,1],154:[2,58]},parseError:function(e,t){if(!t.recoverable){var n=new Error(e);throw n.hash=t,n}this.trace(e)},parse:function(e){var t=this,n=[0],r=[null],i=[],a=this.table,o="",s=0,u=0,l=0,d=2,c=1,f=i.slice.call(arguments,1),h=Object.create(this.lexer),p={yy:{}};for(var y in this.yy)Object.prototype.hasOwnProperty.call(this.yy,y)&&(p.yy[y]=this.yy[y]);h.setInput(e,p.yy),p.yy.lexer=h,p.yy.parser=this,void 0===h.yylloc&&(h.yylloc={});var b=h.yylloc;i.push(b);var T=h.options&&h.options.ranges;"function"==typeof p.yy.parseError?this.parseError=p.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var m,x,v,E,g,N,w,O,k,A=function(){var e;return"number"!=typeof(e=h.lex()||c)&&(e=t.symbols_[e]||e),e},_={};;){if(v=n[n.length-1],this.defaultActions[v]?E=this.defaultActions[v]:(null==m&&(m=A()),E=a[v]&&a[v][m]),void 0===E||!E.length||!E[0]){var I="";for(N in k=[],a[v])this.terminals_[N]&&N>d&&k.push("'"+this.terminals_[N]+"'");I=h.showPosition?"Parse error on line "+(s+1)+":\n"+h.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(s+1)+": Unexpected "+(m==c?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(I,{text:h.match,token:this.terminals_[m]||m,line:h.yylineno,loc:b,expected:k})}if(E[0]instanceof Array&&E.length>1)throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+m);switch(E[0]){case 1:n.push(m),r.push(h.yytext),i.push(h.yylloc),n.push(E[1]),m=null,x?(m=x,x=null):(u=h.yyleng,o=h.yytext,s=h.yylineno,b=h.yylloc,l>0&&l--);break;case 2:if(w=this.productions_[E[1]][1],_.$=r[r.length-w],_._$={first_line:i[i.length-(w||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(w||1)].first_column,last_column:i[i.length-1].last_column},T&&(_._$.range=[i[i.length-(w||1)].range[0],i[i.length-1].range[1]]),void 0!==(g=this.performAction.apply(_,[o,u,s,p.yy,E[1],r,i].concat(f))))return g;w&&(n=n.slice(0,-1*w*2),r=r.slice(0,-1*w),i=i.slice(0,-1*w)),n.push(this.productions_[E[1]][0]),r.push(_.$),i.push(_._$),O=a[n[n.length-2]][n[n.length-1]],n.push(O);break;case 3:return!0}}return!0}};function ce(){this.yy={}}t.parser=de,ce.prototype=de,de.Parser=ce},987:(e,t)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l((function e(){d(this,e)})),f=l((function e(){d(this,e)})),h=l((function e(){d(this,e)})),p=l((function e(){d(this,e)})),y=l((function e(){d(this,e)})),b=l((function e(){d(this,e)})),T=l((function e(){d(this,e)})),m={types:{Text:c,Shortcut:f,Conditional:h,Assignment:p,Literal:y,Expression:b,FunctionCall:T},DialogShortcutNode:function(e){r(n,e);var t=a(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4?arguments[4]:void 0;return d(this,n),(a=t.call(this)).type="DialogShortcutNode",a.text=e,a.content=r,a.lineNum=i.first_line,a.hashtags=o,a.conditionalExpression=s,a}return l(n)}(f),IfNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="IfNode",i.expression=e,i.statement=r,i}return l(n)}(h),IfElseNode:function(e){r(n,e);var t=a(n);function n(e,r,i){var a;return d(this,n),(a=t.call(this)).type="IfElseNode",a.expression=e,a.statement=r,a.elseStatement=i,a}return l(n)}(h),ElseNode:function(e){r(n,e);var t=a(n);function n(e){var r;return d(this,n),(r=t.call(this)).type="ElseNode",r.statement=e,r}return l(n)}(h),ElseIfNode:function(e){r(n,e);var t=a(n);function n(e,r,i){var a;return d(this,n),(a=t.call(this)).type="ElseIfNode",a.expression=e,a.statement=r,a.elseStatement=i,a}return l(n)}(h),TextNode:function(e){r(n,e);var t=a(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return d(this,n),(i=t.call(this)).type="TextNode",i.text=e,i.lineNum=r?r.first_line:-1,i.hashtags=a,i}return l(n)}(c),NumericLiteralNode:function(e){r(n,e);var t=a(n);function n(e){var r;return d(this,n),(r=t.call(this)).type="NumericLiteralNode",r.numericLiteral=e,r}return l(n)}(y),StringLiteralNode:function(e){r(n,e);var t=a(n);function n(e){var r;return d(this,n),(r=t.call(this)).type="StringLiteralNode",r.stringLiteral=e,r}return l(n)}(y),BooleanLiteralNode:function(e){r(n,e);var t=a(n);function n(e){var r;return d(this,n),(r=t.call(this)).type="BooleanLiteralNode",r.booleanLiteral=e,r}return l(n)}(y),VariableNode:function(e){r(n,e);var t=a(n);function n(e){var r;return d(this,n),(r=t.call(this)).type="VariableNode",r.variableName=e,r}return l(n)}(y),UnaryMinusExpressionNode:function(e){r(n,e);var t=a(n);function n(e){var r;return d(this,n),(r=t.call(this)).type="UnaryMinusExpressionNode",r.expression=e,r}return l(n)}(b),ArithmeticExpressionAddNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="ArithmeticExpressionAddNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),ArithmeticExpressionMinusNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="ArithmeticExpressionMinusNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),ArithmeticExpressionMultiplyNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="ArithmeticExpressionMultiplyNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),ArithmeticExpressionExponentNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="ArithmeticExpressionExponentNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),ArithmeticExpressionDivideNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="ArithmeticExpressionDivideNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),ArithmeticExpressionModuloNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="ArithmeticExpressionModuloNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),NegatedBooleanExpressionNode:function(e){r(n,e);var t=a(n);function n(e){var r;return d(this,n),(r=t.call(this)).type="NegatedBooleanExpressionNode",r.expression=e,r}return l(n)}(b),BooleanOrExpressionNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="BooleanOrExpressionNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),BooleanAndExpressionNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="BooleanAndExpressionNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),BooleanXorExpressionNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="BooleanXorExpressionNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),EqualToExpressionNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="EqualToExpressionNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),NotEqualToExpressionNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="NotEqualToExpressionNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),GreaterThanExpressionNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="GreaterThanExpressionNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),GreaterThanOrEqualToExpressionNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="GreaterThanOrEqualToExpressionNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),LessThanExpressionNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="LessThanExpressionNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),LessThanOrEqualToExpressionNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="LessThanOrEqualToExpressionNode",i.expression1=e,i.expression2=r,i}return l(n)}(b),SetVariableEqualToNode:function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).type="SetVariableEqualToNode",i.variableName=e,i.expression=r,i}return l(n)}(p),FunctionResultNode:function(e){r(n,e);var t=a(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return d(this,n),(a=t.call(this)).type="FunctionResultNode",a.functionName=e,a.args=r,a.lineNum=i?i.first_line:-1,a.hashtags=o,a}return l(n)}(T),JumpNode:function(e){r(n,e);var t=a(n);function n(e){var r;return d(this,n),(r=t.call(this)).type="JumpNode",r.destination=e,r}return l(n)}(T),StopNode:function(e){r(n,e);var t=a(n);function n(){var e;return d(this,n),(e=t.call(this)).type="StopNode",e}return l(n)}(T),InlineExpressionNode:function(e){r(n,e);var t=a(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return d(this,n),(i=t.call(this)).type="InlineExpressionNode",i.expression=e,i.lineNum=r.first_line,i.hashtags=a,i}return l(n)}(b)};t.default=m,e.exports=t.default},625:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(987)),i=o(n(271)),a=n(87);function o(e){return e&&e.__esModule?e:{default:e}}a.parser.lexer=new i.default,a.parser.yy=r.default,a.parser.yy.declarations={},a.parser.yy.registerDeclaration=function(e,t,n){if(!this.areDeclarationsHandled){if(this.declarations[e])throw new Error("Duplicate declaration found for variable: ".concat(e));this.declarations[e]={variableName:e,expression:t,explicitType:n}}};var s=a.parser;t.default=s,e.exports=t.default},457:(e,t)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l((function e(){d(this,e)})),f=function(e){r(n,e);var t=a(n);function n(e,r,i){var a;return d(this,n),(a=t.call(this)).text=e,a.hashtags=r,a.metadata=i,a}return l(n)}(c),h=function(e){r(n,e);var t=a(n);function n(e,r,i,a){var o;return d(this,n),(o=t.call(this)).name=e,o.args=r,o.hashtags=i,o.metadata=a,o}return l(n)}(c),p=function(e){r(n,e);var t=a(n);function n(e){var r,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3?arguments[3]:void 0;return d(this,n),(r=t.call(this)).text=e,r.isAvailable=i,r.hashtags=a,r.metadata=o,r}return l(n)}(c),y=function(e){r(n,e);var t=a(n);function n(e,r){var i;return d(this,n),(i=t.call(this)).options=e.map((function(e){return new p(e.text,e.isAvailable,e.hashtags)})),i.metadata=r,i}return l(n,[{key:"select",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;if(e<0||e>=this.options.length)throw new Error("Cannot select option #".concat(e,", there are ").concat(this.options.length," options"));this.selected=e}}]),n}(c),b={Result:c,TextResult:f,CommandResult:h,OptionsResult:y};t.default=b,e.exports=t.default},359:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(n(625)),i=s(n(457)),a=s(n(826)),o=s(n(722));function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function f(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=s(n(987)).default.types,T={Runner:function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.yarnNodes={},this.variables=new a.default,this.functions={},this.visited={},this.registerFunction("visited",(function(e){return!!t.visited[e]}))}var t,n;return t=e,(n=[{key:"load",value:function(e){var t=this,n=e;"string"==typeof e&&(n=(0,o.default)(e)),n.forEach((function(e){if(!e.title)throw new Error("Node needs a title: ".concat(JSON.stringify(e)));if(e.title.split(".").length>1)throw new Error("Node title cannot contain a dot: ".concat(e.title));if(!e.body)throw new Error("Node needs a body: ".concat(JSON.stringify(e)));if(t.yarnNodes[e.title])throw new Error("Duplicate node title: ".concat(e.title));t.yarnNodes[e.title]=e})),r.default.yy.areDeclarationsHandled=!1,r.default.yy.declarations={},this.handleDeclarations(n),r.default.yy.areDeclarationsHandled=!0}},{key:"setVariableStorage",value:function(e){if("function"!=typeof e.set||"function"!=typeof e.get)throw new Error('Variable Storage object must contain both a "set" and "get" function');this.variables=e}},{key:"handleDeclarations",value:function(e){var t=this,n={Number:0,String:"",Boolean:!1},i=e.reduce((function(e,t){var n=t.body.split(/\r?\n+/);return[].concat(f(e),f(n))}),[]).reduce((function(e,t){return t.match(/^<<declare .+>>/)?[].concat(f(e),[t]):e}),[]);i.length&&r.default.parse(i.join("\n")),Object.entries(r.default.yy.declarations).forEach((function(e){var r,i,a=(i=2,function(e){if(Array.isArray(e))return e}(r=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}}(r,i)||h(r,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=a[0],s=a[1],u=s.expression,l=s.explicitType,d=t.evaluateExpressionOrLiteral(u);if(l&&c(d)!==c(n[l]))throw new Error("Cannot declare value ".concat(d," as type ").concat(l," for variable ").concat(o));t.variables.get(o)||t.variables.set(o,d)}))}},{key:"registerFunction",value:function(e,t){if("function"!=typeof t)throw new Error("Registered function must be...well...a function");this.functions[e]=t}},{key:"run",value:regeneratorRuntime.mark((function e(t){var n,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(n=this.yarnNodes[t])){e.next=3;break}throw new Error('Node "'.concat(t,'" does not exist'));case 3:return this.visited[t]=!0,i=Array.from(r.default.parse(n.body)),delete(a=l({},n)).body,e.delegateYield(this.evalNodes(i,a,!0),"t0",8);case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e,this)}))},{key:"evalNodes",value:regeneratorRuntime.mark((function e(t,n,r){var a,o,s,u,l,d,c,f,h,p,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],o=null,s="",u=t.filter(Boolean),l=0;case 5:if(!(l<u.length)){e.next=53;break}if(d=u[l],c=u[l+1],!(o instanceof b.Shortcut)||d instanceof b.Shortcut){e.next=14;break}return e.delegateYield(this.handleShortcuts(a,n),"t0",10);case 10:if(!(f=e.t0)||!f.stop){e.next=13;break}return e.abrupt("return",f);case 13:a=[];case 14:if(!(d instanceof b.Text||d instanceof b.Expression)){e.next=24;break}if(s+=this.evaluateExpressionOrLiteral(d).toString(),!c||d.lineNum!==c.lineNum||!(c instanceof b.Text||c instanceof b.Expression)){e.next=19;break}e.next=22;break;case 19:return e.next=21,new i.default.TextResult(s,d.hashtags,n);case 21:s="";case 22:e.next=49;break;case 24:if(!(d instanceof b.Shortcut)){e.next=28;break}a.push(d),e.next=49;break;case 28:if(!(d instanceof b.Assignment)){e.next=32;break}this.evaluateAssignment(d),e.next=49;break;case 32:if(!(d instanceof b.Conditional)){e.next=41;break}if(!(h=this.evaluateConditional(d))){e.next=39;break}return e.delegateYield(this.evalNodes(h,n),"t1",36);case 36:if(!(p=e.t1)||!p.stop){e.next=39;break}return e.abrupt("return",p);case 39:e.next=49;break;case 41:if("JumpNode"!==d.type){e.next=44;break}return e.delegateYield(this.run(d.destination),"t2",43);case 43:return e.abrupt("return",r?void 0:{stop:!0});case 44:if("StopNode"!==d.type){e.next=46;break}return e.abrupt("return",r?void 0:{stop:!0});case 46:return y=d.args.map(this.evaluateExpressionOrLiteral,this),e.next=49,new i.default.CommandResult(d.functionName,y,d.hashtags,n);case 49:o=d;case 50:l+=1,e.next=5;break;case 53:if(!(a.length>0)){e.next=56;break}return e.delegateYield(this.handleShortcuts(a,n),"t3",55);case 55:return e.abrupt("return",e.t3);case 56:return e.abrupt("return",void 0);case 57:case"end":return e.stop()}}),e,this)}))},{key:"handleShortcuts",value:regeneratorRuntime.mark((function e(t,n){var r,a,o,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.map((function(e){var t,n=!0;return e.conditionalExpression&&!s.evaluateExpressionOrLiteral(e.conditionalExpression)&&(n=!1),t=e.text.reduce((function(e,t){return e+s.evaluateExpressionOrLiteral(t).toString()}),""),Object.assign(e,{isAvailable:n,text:t})})),a=new i.default.OptionsResult(r,n),e.next=4,a;case 4:if("number"!=typeof a.selected){e.next=11;break}if(!(o=r[a.selected]).content){e.next=9;break}return e.delegateYield(this.evalNodes(o.content,n),"t0",8);case 8:return e.abrupt("return",e.t0);case 9:e.next=12;break;case 11:throw new Error("No option selected before resuming dialogue");case 12:return e.abrupt("return",void 0);case 13:case"end":return e.stop()}}),e,this)}))},{key:"evaluateAssignment",value:function(e){var t=this.evaluateExpressionOrLiteral(e.expression),n=this.variables.get(e.variableName);if(n&&c(n)!==c(t))throw new Error("Variable ".concat(e.variableName," is already type ").concat(c(n),"; cannot set equal to ").concat(t," of type ").concat(c(t)));this.variables.set(e.variableName,t)}},{key:"evaluateConditional",value:function(e){if("IfNode"===e.type){if(this.evaluateExpressionOrLiteral(e.expression))return e.statement}else{if("IfElseNode"!==e.type&&"ElseIfNode"!==e.type)return e.statement;if(this.evaluateExpressionOrLiteral(e.expression))return e.statement;if(e.elseStatement)return this.evaluateConditional(e.elseStatement)}return null}},{key:"evaluateFunctionCall",value:function(e){var t;if(this.functions[e.functionName])return(t=this.functions)[e.functionName].apply(t,f(e.args.map(this.evaluateExpressionOrLiteral,this)));throw new Error('Function "'.concat(e.functionName,'" not found'))}},{key:"evaluateExpressionOrLiteral",value:function(e){var t=this,n={UnaryMinusExpressionNode:function(e){return-e},ArithmeticExpressionAddNode:function(e,t){return e+t},ArithmeticExpressionMinusNode:function(e,t){return e-t},ArithmeticExpressionExponentNode:function(e,t){return Math.pow(e,t)},ArithmeticExpressionMultiplyNode:function(e,t){return e*t},ArithmeticExpressionDivideNode:function(e,t){return e/t},ArithmeticExpressionModuloNode:function(e,t){return e%t},NegatedBooleanExpressionNode:function(e){return!e},BooleanOrExpressionNode:function(e,t){return e||t},BooleanAndExpressionNode:function(e,t){return e&&t},BooleanXorExpressionNode:function(e,t){return!!(e^t)},EqualToExpressionNode:function(e,t){return e===t},NotEqualToExpressionNode:function(e,t){return e!==t},GreaterThanExpressionNode:function(e,t){return e>t},GreaterThanOrEqualToExpressionNode:function(e,t){return e>=t},LessThanExpressionNode:function(e,t){return e<t},LessThanOrEqualToExpressionNode:function(e,t){return e<=t},TextNode:function(e){return e.text},NumericLiteralNode:function(e){return parseFloat(e.numericLiteral)},StringLiteralNode:function(e){return"".concat(e.stringLiteral)},BooleanLiteralNode:function(e){return"true"===e.booleanLiteral},VariableNode:function(e){return t.variables.get(e.variableName)},FunctionResultNode:function(e){return t.evaluateFunctionCall(e)},InlineExpressionNode:function(e){return e}}[e.type];if(!n)throw new Error("node type not recognized: ".concat(e.type));return n(e instanceof b.Expression?this.evaluateExpressionOrLiteral(e.expression||e.expression1):e,e.expression2?this.evaluateExpressionOrLiteral(e.expression2):e)}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),TextResult:i.default.TextResult,CommandResult:i.default.CommandResult,OptionsResult:i.default.OptionsResult};t.default=T,e.exports=t.default}},t={};return function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}(352)})()}));